<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>platform/modules/privatehive.js - Blockcluster NodeJS SDK</title>
    
    
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="wrap">
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://www.blockcluster.io/" target="_blank" class="menu-item" id="website_link" >Project Website</a></h2><h2><a href="https://forum.blockcluster.io/" target="_blank" class="menu-item" id="forum_link" >Forum</a></h2><h3>Classes</h3><ul><li><a href="Hyperion.html">Hyperion</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Hyperion.html#deleteFile">deleteFile</a></li><li data-type='method' style='display: none;'><a href="Hyperion.html#getFile">getFile</a></li><li data-type='method' style='display: none;'><a href="Hyperion.html#uploadFile">uploadFile</a></li></ul></li><li><a href="Paymeter.html">Paymeter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Paymeter.html#createWallet">createWallet</a></li><li data-type='method' style='display: none;'><a href="Paymeter.html#getDeposits">getDeposits</a></li><li data-type='method' style='display: none;'><a href="Paymeter.html#getWallets">getWallets</a></li><li data-type='method' style='display: none;'><a href="Paymeter.html#getWithdrawals">getWithdrawals</a></li><li data-type='method' style='display: none;'><a href="Paymeter.html#refreshBalance">refreshBalance</a></li><li data-type='method' style='display: none;'><a href="Paymeter.html#send">send</a></li></ul></li><li><a href="Platform.html">Platform</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Platform.html#acceptInvite">acceptInvite</a></li><li data-type='method' style='display: none;'><a href="Platform.html#acceptPrivatehiveChannelInvite">acceptPrivatehiveChannelInvite</a></li><li data-type='method' style='display: none;'><a href="Platform.html#createNetwork">createNetwork</a></li><li data-type='method' style='display: none;'><a href="Platform.html#createPrivatehiveNetwork">createPrivatehiveNetwork</a></li><li data-type='method' style='display: none;'><a href="Platform.html#deleteNetwork">deleteNetwork</a></li><li data-type='method' style='display: none;'><a href="Platform.html#deletePrivatehiveNetwork">deletePrivatehiveNetwork</a></li><li data-type='method' style='display: none;'><a href="Platform.html#fetchLocations">fetchLocations</a></li><li data-type='method' style='display: none;'><a href="Platform.html#fetchNetworkTypes">fetchNetworkTypes</a></li><li data-type='method' style='display: none;'><a href="Platform.html#getPrivatehiveNode">getPrivatehiveNode</a></li><li data-type='method' style='display: none;'><a href="Platform.html#inviteUserToChannel">inviteUserToChannel</a></li><li data-type='method' style='display: none;'><a href="Platform.html#inviteViaEmail">inviteViaEmail</a></li><li data-type='method' style='display: none;'><a href="Platform.html#joinNetwork">joinNetwork</a></li><li data-type='method' style='display: none;'><a href="Platform.html#listPrivatehiveChannelInvites">listPrivatehiveChannelInvites</a></li><li data-type='method' style='display: none;'><a href="Platform.html#listPrivatehiveNetworks">listPrivatehiveNetworks</a></li></ul></li><li><a href="PrivatehiveNode.html">PrivatehiveNode</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#addChaincode">addChaincode</a></li><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#createChannel">createChannel</a></li><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#fetchChaincodes">fetchChaincodes</a></li><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#fetchChannels">fetchChannels</a></li><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#installChaincode">installChaincode</a></li><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#instantiateChaincode">instantiateChaincode</a></li><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#setAuth">setAuth</a></li><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#setDomain">setDomain</a></li><li data-type='method' style='display: none;'><a href="PrivatehiveNode.html#setOrderer">setOrderer</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="Chaincode.html">Chaincode</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Chaincode.html#add">add</a></li><li data-type='method' style='display: none;'><a href="Chaincode.html#install">install</a></li><li data-type='method' style='display: none;'><a href="Chaincode.html#instantiate">instantiate</a></li><li data-type='method' style='display: none;'><a href="Chaincode.html#invoke">invoke</a></li><li data-type='method' style='display: none;'><a href="Chaincode.html#list">list</a></li><li data-type='method' style='display: none;'><a href="Chaincode.html#query">query</a></li><li data-type='method' style='display: none;'><a href="Chaincode.html#upgrade">upgrade</a></li></ul></li><li><a href="Channel.html">Channel</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Channel.html#create">create</a></li><li data-type='method' style='display: none;'><a href="Channel.html#list">list</a></li></ul></li><li><a href="Config.html">Config</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Config.html#cryptoConfig">cryptoConfig</a></li><li data-type='method' style='display: none;'><a href="Config.html#ordererCerts">ordererCerts</a></li><li data-type='method' style='display: none;'><a href="Config.html#ordererCerts">ordererCerts</a></li><li data-type='method' style='display: none;'><a href="Config.html#orgDetails">orgDetails</a></li></ul></li><li><a href="Explore.html">Explore</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Explore.html#block">block</a></li><li data-type='method' style='display: none;'><a href="Explore.html#blocks">blocks</a></li><li data-type='method' style='display: none;'><a href="Explore.html#chaincodesInstantiated">chaincodesInstantiated</a></li><li data-type='method' style='display: none;'><a href="Explore.html#latestBlock">latestBlock</a></li><li data-type='method' style='display: none;'><a href="Explore.html#listOrgs">listOrgs</a></li><li data-type='method' style='display: none;'><a href="Explore.html#transaction">transaction</a></li></ul></li><li><a href="Notification.html">Notification</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Notification.html#add">add</a></li><li data-type='method' style='display: none;'><a href="Notification.html#list">list</a></li><li data-type='method' style='display: none;'><a href="Notification.html#update">update</a></li><li data-type='method' style='display: none;'><a href="Notification.html#update">update</a></li></ul></li><li><a href="Privatehive.html">Privatehive</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Privatehive.html#acceptChannelInvitation">acceptChannelInvitation</a></li><li data-type='method' style='display: none;'><a href="Privatehive.html#create">create</a></li><li data-type='method' style='display: none;'><a href="Privatehive.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="Privatehive.html#getNode">getNode</a></li><li data-type='method' style='display: none;'><a href="Privatehive.html#inviteUserToChannel">inviteUserToChannel</a></li><li data-type='method' style='display: none;'><a href="Privatehive.html#list">list</a></li><li data-type='method' style='display: none;'><a href="Privatehive.html#listChannelInvites">listChannelInvites</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#Block">Block</a></li><li><a href="global.html#ChaincodeType">ChaincodeType</a></li><li><a href="global.html#ChannelType">ChannelType</a></li><li><a href="global.html#NotificationEvent">NotificationEvent</a></li><li><a href="global.html#OrgDetails">OrgDetails</a></li><li><a href="global.html#Transaction">Transaction</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">platform/modules/privatehive.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const helpers = require('../../../helpers');
const PrivatehiveNode = require('../../privatehive');
/**
 * @namespace Privatehive
 * @since 3.0.1
 */
module.exports = node => ({
  /**
   * Creates a privatehive node
   * @function
   * @name create
   * @param  {object} options Options
   * @param {string} [options.peerId] Peer Id to which the orderer joins. Required only incase of orderer type
   * @param {string} options.locationCode Location code where the network should be deployed
   * @param {peer|orderer} options.type Type of network. Either peer or orderer
   * @param {string} [options.voucherCode] Voucher code to be applied
   * @param {string} options.name Name of the network. Required
   * @param {string} options.orgName Organization to which the node belongs to
   * @param {solo|kafka} [options.ordererType] Type of orderer to be created. Solo or Kafka. Required only if type is orderer
   * @param {stirng} options.networkConfigId ID of network configuration
   * @param {number} [options.diskSpace] Disk space required for this node. Applicable only if network configuration has isDiskChangeable = true
   * @returns {string} Instance ID of the created network
   * @example &lt;caption>Create a privatehive network of type peer&lt;/caption>
   *   const peerId = await platform.privatehive.create({
   *   locationCode: 'us-west-2',
   *   type: 'peer',
   *   orgName: 'blockcluster',
   *   name: `Peer 1`,
   *   networkConfigId: 'abcgdghfjgmgh',
   * });
   * console.log(peerId);
   * // Prints the instance id of the created node
   * @memberof Privatehive
   * @instance
   */
  create: async ({ peerId, locationCode, type, voucherCode, name, orgName, ordererType, networkConfigId, diskSpace }) => {
    if (type === 'orderer' &amp;&amp; !peerId) {
      return Promise.reject(new Error('PeerID is required to create orderer'));
    }

    if (!name) {
      return Promise.reject(new Error('Name is required'));
    }

    if (!orgName) {
      return Promise.reject(new Error('Organization Name is required'));
    }

    if (type === 'orderer' &amp;&amp; !ordererType) {
      console.warn('OrdererType not specified. Defaulting to solo');
      ordererType = 'solo';
    }

    if (!networkConfigId) {
      return Promise.reject(new Error('Network configuration id is required'));
    }

    if (!locationCode) {
      return Promise.reject(new Error('Location code is required'));
    }

    const body = {
      locationCode,
      name,
      orgName,
      networkConfigId,
      diskSpace,
      voucherCode,
      type,
    };

    if (type === 'orderer') {
      body.ordererType = ordererType;
      body.peerId = peerId;
    }

    const path = '/api/platform/privatehive';

    try {
      const res = await helpers.sendPlatformRequest({ domain: node.domain, path, method: 'POST', body, apiKey: node.apiKey });
      return res.data.instanceId;
    } catch (err) {
      return Promise.reject(err);
    }
  },

  /**
   * Lists details of privatehive networks
   * @function
   * @name list
   * @param  {string} [instanceId] If provided then fetches details of only this instance
   * @param  {object} options Additional filters
   * @param {bool} [options.showDeleted] If true then shows all the deleted networks as well
   * @param {peer|orderer} [options.nodeType] Queries only a particular type of node
   * @param {string} [options.locationCode] Queries networks only in this location
   * @param {date} [options.createdAfter] Queries networks created after this date
   * @param {date} [options.createdBefore] Queries networks created before this date
   * @returns {Array&lt;Node>} Array of networks matching the filters
   * @example &lt;caption>Lists all the active privatehive networks&lt;/caption>
   * const networks = await platform.privatehive.list({ showDeleted: false });
   * console.log(networks);
   * // Prints List of networks
   * @example &lt;caption>List details of single network&lt;/caption>
   * const networks = await platform.privatehive.list('instanceId1123);
   * console.log(networks);
   * // Prints List containing one network of the given instanceId
   * @memberof Privatehive
   * @instance
   */
  list: async (instanceId, options = {}) => {
    let path = '/api/platform/privatehive';
    if (instanceId &amp;&amp; typeof instanceId === 'string') {
      path = `${path}/${instanceId}`;
    } else {
      options = instanceId;
    }

    const { nodeType, locationCode, createdAfter, createdBefore } = options;
    let { showDeleted } = options;

    showDeleted = Boolean(showDeleted);
    path = `${path}?showDeleted=${showDeleted}`;
    if (nodeType) {
      path = `${path}&amp;nodeType=${nodeType}`;
    }

    if (locationCode) {
      path = `${path}&amp;locationCode=${locationCode}`;
    }

    if (createdAfter) {
      path = `${path}&amp;createdAfter=${createdAfter}`;
    }

    if (createdBefore) {
      path = `${path}&amp;createdBefore=${createdBefore}`;
    }

    try {
      const res = await helpers.sendPlatformRequest({ domain: node.domain, path, method: 'GET', apiKey: node.apiKey });
      return res.data;
    } catch (err) {
      return Promise.reject(err);
    }
  },

  /**
   * Delets a privatehive node
   * @function
   * @name delete
   * @param  {string} networkId Instance ID of the network to be deleted
   * @returns {string} InstanceID of deleted network
   * @example &lt;caption>Deletes a privatehive node&lt;/caption>
   * const instanceID = await platform.privatehive.delete('instanceId1234');
   * console.log(instanceID);
   * // Prints the instanceid of deleted network
   * @memberof Privatehive
   * @instance
   */
  delete: async networkId => {
    const path = `/api/platform/privatehive/${networkId}`;

    try {
      const res = await helpers.sendPlatformRequest({ domain: node.domain, path, method: 'DELETE', apiKey: node.apiKey });
      return res.data.instanceId;
    } catch (err) {
      return Promise.reject(err);
    }
  },
  /**
   * Invites a user to a HLF channel. The invited user can select the peer which will join the channel
   * @function
   * @name inviteUserToChannel
   * @param  {object} params Options
   * @param {string} params.email Email of the user to be invited
   * @param {string} params.peerId Instance ID of the peer to be invited
   * @param {string} params.channelName Channel to which the user should be invited to
   * @param {string} params.ordererDomain Domain of the orderer
   * @param {string} params.ordererConnectionDetails Connection details of the orderer like "grpc://1.2.3.4:1234"
   * @returns {string} Invite ID
   * @example &lt;caption>Invites a user to a channel&lt;/caption>
   * const inviteID = await platform.privatehive.inviteUserToChannel({
   *    email: 'jibin.mathews@blockcluster.io',
   *    peerId: 'inviteInstancePeerID',
   *    channelName: 'mychannel',
   *    ordererDomain: `orderer.${orderer.organization.toLowerCase()}.com`,
   *    ordererConnectionDetails: `grpc://${orderer.ordererURL}`,
   * });
   * console.log(inviteID);
   * // Prints the inviteID for others to accept
   * @memberof Privatehive
   * @instance
   */
  inviteUserToChannel: async ({ email, peerId, channelName, ordererDomain, ordererConnectionDetails }) => {
    const path = '/api/platform/privatehive/invite';
    const body = {
      email,
      networkId: peerId,
      channelName,
      ordererDomain,
      ordererConnectionDetails,
    };

    try {
      const res = await helpers.sendPlatformRequest({ domain: node.domain, path, method: 'POST', body, apiKey: node.apiKey });
      return res.data.inviteId;
    } catch (err) {
      return Promise.reject(err);
    }
  },

  /**
   * Accepts an invite to join a channel
   * @function
   * @name acceptChannelInvitation
   * @param  {string} inviteId InviteID to be accepted
   * @param  {string} peerId InstanceID of the peer to join the channel
   * @returns {string} InstanceID of the joined peer
   * @example &lt;caption>Accepts a channel invitation&lt;/caption>
   * const instanceID = await platform.privatehive.acceptChannelInvitation('inviteid123', 'peerid123');
   * console.log(instanceID);
   * // Prints the instanceID of the joined peer
   * @memberof Privatehive
   * @instance
   */
  acceptChannelInvitation: async (inviteId, peerId) => {
    const path = `/api/platform/privatehive/invite/accept/${inviteId}`;
    const body = {
      peerId,
    };
    try {
      const res = await helpers.sendPlatformRequest({ domain: node.domain, path, method: 'POST', body, apiKey: node.apiKey });
      return res.data.instanceId;
    } catch (err) {
      return Promise.reject(err);
    }
  },
  /**
   * Lists all pending privatehive channel invites
   * @function
   * @name listChannelInvites
   * @returns {Array&lt;Invite>} List of invites
   * @example &lt;caption>Lists all the pending channel invitation&lt;/caption>
   * const invites = await platform.privatehive.listChannelInvites();
   * console.log(invites);
   * // Prints the pending invitations
   * @memberof Privatehive
   * @instance
   */
  listChannelInvites: async () => {
    const path = '/api/platform/privatehive/invite';
    try {
      const res = await helpers.sendPlatformRequest({ domain: node.domain, path, method: 'GET', apiKey: node.apiKey });
      return res.data;
    } catch (err) {
      return Promise.reject(err);
    }
  },

  /**
   * Returns privatehive node object to operate on it
   * @function
   * @name getNode
   * @param  {object} nodeInfo Node information details. Can be fetched from listPrivatehiveNetworks(instanceId)
   * @returns {PrivatehiveNode} Privatehive node instance
   * @memberof Privatehive
   * @instance
   */
  getNode: async nodeInfo => {
    const _node = { ...nodeInfo };
    if (nodeInfo.ordererType) {
      nodeInfo.type = 'orderer';
    }

    return new PrivatehiveNode(_node);
  },
});
</code></pre>
        </article>
    </section>




    
    
    <div id="disqus_thread"></div>
    <script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//https://forum.blockcluster.io/.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Apr 29 2019 12:25:32 GMT+0530 (IST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
