<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>paymeter/index.js - Postman Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Hyperion.html">Hyperion</a><ul class='methods'><li data-type='method'><a href="Hyperion.html#deleteFile">deleteFile</a></li><li data-type='method'><a href="Hyperion.html#getFile">getFile</a></li><li data-type='method'><a href="Hyperion.html#uploadFile">uploadFile</a></li></ul></li><li><a href="Paymeter.html">Paymeter</a><ul class='methods'><li data-type='method'><a href="Paymeter.html#createWallet">createWallet</a></li><li data-type='method'><a href="Paymeter.html#getDeposits">getDeposits</a></li><li data-type='method'><a href="Paymeter.html#getWallets">getWallets</a></li><li data-type='method'><a href="Paymeter.html#getWithdrawals">getWithdrawals</a></li><li data-type='method'><a href="Paymeter.html#send">send</a></li></ul></li><li><a href="Platform.html">Platform</a><ul class='methods'><li data-type='method'><a href="Platform.html#acceptInvite">acceptInvite</a></li><li data-type='method'><a href="Platform.html#createNetwork">createNetwork</a></li><li data-type='method'><a href="Platform.html#deleteNetwork">deleteNetwork</a></li><li data-type='method'><a href="Platform.html#fetchLocations">fetchLocations</a></li><li data-type='method'><a href="Platform.html#fetchNetworkTypes">fetchNetworkTypes</a></li><li data-type='method'><a href="Platform.html#inviteViaEmail">inviteViaEmail</a></li><li data-type='method'><a href="Platform.html#joinNetwork">joinNetwork</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">paymeter/index.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const helpers = require('../../helpers');

/**
 * Handles all function related to paymeter
 * @class Paymeter
 */
class Paymeter {
  constructor({ apiKey }) {
    this.apiKey = apiKey;
  }

  /**
   * Creates a new wallet in the blockcluster account
   * @param {object} options Wallet configuration
   * @param {string} options.coinType Coin type Eg: ETH, ERC20 etc
   * @param {string} options.walletName Name of the wallet
   * @param {string} options.network Network on which the wallet will function Eg: testnet or mainnet
   * @param {string} options.password Password for the wallet
   * @param {string} [options.contractAddress] Contract address for ERC20 type token
   * @param {string} [options.tokenSymbol] Symbol for ERC20 token
   * @example &lt;caption>Creates a wallet&lt;/caption>
   * const walletId = await paymeter.createWallet({coinType: 'ETH', walletName: 'My ETH Wallet', network: 'mainnet', password: '1234567890' });
   * console.log(walletId);
   * // Prints the walletId &lt;random string>
   * @return {Promise&lt;string>} Wallet id
   * @memberof Paymeter
   */
  async createWallet({ coinType, walletName, network, password, contractAddress, tokenSymbol }) {
    if (!(coinType &amp;&amp; walletName &amp;&amp; network &amp;&amp; password)) {
      return Promise.reject(new Error('CoinType, walletName, network and password are required fields'));
    }

    const path = '/api/paymeter/wallets';

    const body = {
      coinType,
      walletName,
      network,
      options: {
        password,
      },
    };

    if (coinType.toLowerCase() === 'erc20') {
      body.options.contractAddress = contractAddress;
      body.options.tokenSymbol = tokenSymbol;
    }

    try {
      const resp = await helpers.sendPlatformRequest({
        path,
        method: 'POST',
        body,
        apiKey: this.apiKey,
      });
      return resp.data;
    } catch (err) {
      return Promise.reject(err);
    }
  }

  /**
   * Fetches all the wallets or a single wallet details
   * @param  {string} [walletId] Id of the wallet for the details needs to be fetched. If undefined then fetches all wallets
   * @example &lt;caption>Fetches all wallets&lt;/caption>
   * const wallets = await paymeter.getWallets();
   * console.log(wallets);
   * // Prints [{_id: '...', ...}, ...]
   * @example &lt;caption>Fetches details of single wallet&lt;/caption>
   * const wallet = await paymeter.getWallets('abcdefghi');
   * console.log(wallet);
   * // Prints {_id: 'abcdefghi', ...}
   * @return {Promise&lt;array|object>} An array of wallets or single wallet description
   * @memberof Paymeter
   */
  async getWallets(walletId) {
    let path = '/api/paymeter/wallets';

    if (walletId) {
      path = `${path}/${walletId}`;
    }

    try {
      const resp = await helpers.sendPlatformRequest({
        path,
        method: 'GET',
        apiKey: this.apiKey,
      });
      if (walletId) {
        delete resp.data.wallet.privateKey;
        return resp.data.wallet;
      }
      return resp.data;
    } catch (err) {
      return Promise.reject(err);
    }
  }

  /**
   * Fetches all the withdrawals happend for a wallet
   * @param  {string} walletId Id of the wallet for which the transactions need to be fetched
   * @example &lt;caption>Fetches all withdrawals for a wallet&lt;/caption>
   * const withdrawals = await paymeter.getWithdrawals('abcdefghi');
   * console.log(withdrawals);
   * // Prints [{...withdrawal1}, {...}, ...]
   * @return {Promise&lt;array>} Array of withdrawals
   * @memberof Paymeter
   */
  async getWithdrawals(walletId) {
    const path = `/api/paymeter/wallets/${walletId}/withdrawals`;

    if (!walletId) {
      return Promise.reject(new Error('walletId is a required option'));
    }

    try {
      const resp = await helpers.sendPlatformRequest({
        path,
        method: 'GET',
        apiKey: this.apiKey,
      });
      return resp.data;
    } catch (err) {
      return Promise.reject(err);
    }
  }

  /**
   * Fetches all the deposits happend for a wallet
   * @param  {string} walletId Id of the wallet for which the transactions need to be fetched
   * @example &lt;caption>Fetches all deposits for a wallet&lt;/caption>
   * const deposits = await paymeter.getDeposits('abcdefghi');
   * console.log(deposits);
   * // Prints [{...deposit1}, {...}, ...]
   * @return {Promise&lt;array>} Array of deposits
   * @memberof Paymeter
   */
  async getDeposits(walletId) {
    const path = `/api/paymeter/wallets/${walletId}/deposits`;

    if (!walletId) {
      return Promise.reject(new Error('walletId is a required option'));
    }

    try {
      const resp = await helpers.sendPlatformRequest({
        path,
        method: 'GET',
        apiKey: this.apiKey,
      });
      return resp.data;
    } catch (err) {
      return Promise.reject(err);
    }
  }

  /**
   * Transfers token from a wallet to specified address
   * @param {object} options Wallet configuration
   * @param {string} options.fromWalletId Id of the wallet from which to transfer tokens
   * @param {string} options.toAddress Address to which tokens are to be transferred
   * @param {string} options.amount Amount of tokens to be transferred. Maximum of 5 decimal places
   * @param {string} options.password Password for the wallet from which tokens are to be transferred
   * @param {string} [options.feeWalletId] Only for ERC20 tokens, wallet Id from where the transaction fee is to be deducted
   * @param {string} [options.feeWalletPassword] Only for ERC20 tokens, password for the feeWallet specified &lt;i>(&lt;b>Required&lt;/b> if feeWalletId is specified)&lt;/i>
   * @param {string} [options.feeCollectWalletId] Wallet ID to which the gas fees is to be collected
   * @param {string} [options.tokenValueInEth] Value of ERC20 token in ETH i.e., 1 ERC20 Token = ? ETH &lt;i>(&lt;b>Required&lt;/b> if feeCollectWalletId is specified)&lt;/i>
   * @return {Promise&lt;string>} Transaction id
   * @memberof Paymeter
   */
  async send({ fromWalletId, toAddress, amount, password, feeWalletId, feeWalletPassword, feeCollectWalletId, tokenValueInEth }) {
    if (!fromWalletId) {
      return Promise.reject(new Error('walletId is a required option'));
    }

    if (!(fromWalletId &amp;&amp; toAddress &amp;&amp; amount &amp;&amp; password)) {
      return Promise.reject(new Error('fromWalletId,  toAddress,  amount, password are required fields'));
    }

    const path = `/api/paymeter/wallets/${fromWalletId}/send`;

    const body = {
      toAddress,
      amount,
      options: {
        password,
      },
    };

    if (feeWalletId) {
      body.options.feeWalletId = feeWalletId;
      body.options.feeWalletPassword = feeWalletPassword;
    }

    if (feeCollectWalletId) {
      body.options.feeCollectWalletId = feeCollectWalletId;
      body.options.tokenValueInEth = tokenValueInEth;
    }

    try {
      const resp = await helpers.sendPlatformRequest({
        path,
        method: 'POST',
        body,
        apiKey: this.apiKey,
      });
      return resp.data.txnHash || resp.data.txnId;
    } catch (err) {
      return Promise.reject(err);
    }
  }
}

module.exports = Paymeter;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated at Mon Jan 07 2019 17:49:55 GMT+0530 (IST)
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
